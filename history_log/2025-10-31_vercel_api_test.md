# 2025-10-31: Vercel API ν…μ¤νΈ κ²°κ³Ό

## π“‹ ν…μ¤νΈ κ°μ”

- **λ°°ν¬ URL**: https://invest-web-service.vercel.app
- **ν…μ¤νΈ μΌμ‹**: 2025-10-31 13:30 (KST)
- **ν…μ¤νΈ λ°©λ²•**: curl + bash μ¤ν¬λ¦½νΈ
- **ν…μ¤νΈ λ²”μ„**: μ£Όμ” API μ—”λ“ν¬μΈνΈ 15κ°

---

## π― ν…μ¤νΈ κ²°κ³Ό μ”μ•½

### μ „μ²΄ ν†µκ³„
- β… **μ„±κ³µ**: 11/15 (73.3%)
- β **μ‹¤ν¨**: 4/15 (26.7%)
- π“ **λ°°ν¬ μƒνƒ**: μ •μƒ (Ready)

### μ„±κ³µλ¥  λ¶„μ„
- **κΈ°λ³Έ νμ΄μ§€**: 100% (2/2)
- **μ£Όμ‹ κ΄€λ ¨ API**: 100% (3/3)
- **ν¬νΈν΄λ¦¬μ¤ κ΄€λ ¨ API**: 100% (4/4)
- **λ¶„μ„ API**: 100% (2/2)
- **λ‰΄μ¤/λ¦¬ν¬νΈ API**: 50% (1/2) - userId νλΌλ―Έν„° ν•„μ”
- **κΈ°νƒ€ API**: 100% (2/2)

---

## β… μ„±κ³µν• API μ—”λ“ν¬μΈνΈ

### 1. κΈ°λ³Έ νμ΄μ§€ (2/2)

#### 1-1. ν™νμ΄μ§€
```bash
GET https://invest-web-service.vercel.app/
```
- **μƒνƒ**: β… 200 OK
- **μ‘λ‹µ**: HTML νμ΄μ§€ μ •μƒ λ΅λ”©
- **λΉ„κ³ **: React μ•± μ •μƒ λ λ”λ§

#### 1-2. λ΅κ·ΈμΈ νμ΄μ§€
```bash
GET https://invest-web-service.vercel.app/login
```
- **μƒνƒ**: β… 200 OK
- **μ‘λ‹µ**: λ΅κ·ΈμΈ νμ΄μ§€ μ •μƒ λ΅λ”©
- **λΉ„κ³ **: Firebase Auth μ—°λ™ μ¤€λΉ„ μ™„λ£

---

### 2. μ£Όμ‹ κ²€μƒ‰ API (3/3)

#### 2-1. μ£Όμ‹ κ²€μƒ‰ (AAPL)
```bash
GET https://invest-web-service.vercel.app/api/stocks/search?q=AAPL
```
- **μƒνƒ**: β… 200 OK
- **μ‘λ‹µ**:
```json
{
  "success": true,
  "data": [
    {
      "symbol": "AAPL",
      "name": "Apple Inc",
      "market": "US",
      "assetType": "stock",
      "currency": "USD",
      "exchange": "United States"
    }
  ],
  "count": 4,
  "query": "AAPL"
}
```
- **λΉ„κ³ **: Alpha Vantage API μ •μƒ μ‘λ™

#### 2-2. μΈκΈ° μΆ…λ© μ΅°ν
```bash
GET https://invest-web-service.vercel.app/api/stocks/search?popular=true
```
- **μƒνƒ**: β… 200 OK
- **μ‘λ‹µ**: 8κ° μΈκΈ° μΆ…λ© λ°ν™ (AAPL, MSFT, GOOGL, TSLA, NVDA, SPY, QQQ, μ‚Όμ„±μ „μ)
- **λΉ„κ³ **: ν•λ“μ½”λ”©λ μΈκΈ° μΆ…λ© λ¦¬μ¤νΈ μ •μƒ μ‘λ™

#### 2-3. μ£Όμ‹ λ§μ¤ν„° λ°μ΄ν„°
```bash
GET https://invest-web-service.vercel.app/api/stocks/master
```
- **μƒνƒ**: β… 200 OK
- **μ‘λ‹µ**: λΉ λ°°μ—΄ (μ•„μ§ λ§μ¤ν„° λ°μ΄ν„° μ—†μ)
- **λΉ„κ³ **: API μμ²΄λ” μ •μƒ μ‘λ™

---

### 3. ν¬νΈν΄λ¦¬μ¤ κ΄€λ ¨ API (4/4)

#### 3-1. ν¬μ§€μ… λ©λ΅ μ΅°ν
```bash
GET https://invest-web-service.vercel.app/api/positions?portfolioId=main
```
- **μƒνƒ**: β… 200 OK
- **μ‘λ‹µ**:
```json
{
  "positions": [
    {
      "id": "main_MGK",
      "symbol": "MGK",
      "shares": 0,
      "averagePrice": 0,
      "totalValue": 0,
      "profitLoss": 0,
      "returnRate": 0,
      "purchaseMethod": "auto",
      "autoInvestConfig": {
        "isActive": true,
        "frequency": "daily",
        "startDate": "2025-09-10",
        "amount": 5
      }
    }
  ],
  "totals": {
    "totalInvested": 0,
    "totalValue": 0,
    "returnRate": 0
  }
}
```
- **λΉ„κ³ **: Firestore μ—°λ™ μ •μƒ, κΈ°μ΅΄ ν¬μ§€μ… λ°μ΄ν„° μ΅°ν μ„±κ³µ

#### 3-2. κ±°λ λ‚΄μ—­ μ΅°ν
```bash
GET https://invest-web-service.vercel.app/api/transactions?portfolioId=main
```
- **μƒνƒ**: β… 200 OK
- **μ‘λ‹µ**: `{ "transactions": [] }`
- **λΉ„κ³ **: μ•„μ§ κ±°λ λ‚΄μ—­ μ—†μ (μ •μƒ)

#### 3-3. μ”κ³  μ΅°ν
```bash
GET https://invest-web-service.vercel.app/api/balance?portfolioId=main
```
- **μƒνƒ**: β… 200 OK
- **μ‘λ‹µ**: `{ "balances": { "KRW": 0, "USD": 0 } }`
- **λΉ„κ³ **: μ”κ³  μ‹μ¤ν… μ •μƒ μ‘λ™

#### 3-4. ν™μ¨ μ΅°ν
```bash
GET https://invest-web-service.vercel.app/api/exchange-rate?from=USD&to=KRW
```
- **μƒνƒ**: β… 200 OK
- **μ‘λ‹µ**: μ‹¤μ‹κ°„ ν™μ¨ λ°μ΄ν„° λ°ν™
- **λΉ„κ³ **: μ™Έλ¶€ ν™μ¨ API μ—°λ™ μ •μƒ

---

### 4. λ¶„μ„ API (2/2)

#### 4-1. ν¬νΈν΄λ¦¬μ¤ λ¶„μ„
```bash
GET https://invest-web-service.vercel.app/api/portfolio/analysis?portfolioId=main
```
- **μƒνƒ**: β… 200 OK
- **μ‘λ‹µ**:
```json
{
  "success": true,
  "analysis": {
    "portfolioId": "main",
    "totalValue": 0,
    "totalInvested": 0,
    "overallReturnRate": 0,
    "sectorAllocation": [...],
    "regionAllocation": [...],
    "assetAllocation": [...],
    "riskMetrics": {
      "volatility": 0,
      "sharpeRatio": 0,
      "maxDrawdown": 0,
      "concentration": 0
    },
    "topContributors": [...],
    "rebalancingSuggestions": [...]
  }
}
```
- **λΉ„κ³ **: ν¬νΈν΄λ¦¬μ¤ λ¶„μ„ μ—”μ§„ μ •μƒ μ‘λ™

#### 4-2. ν†µκ³„ μ΅°ν
```bash
GET https://invest-web-service.vercel.app/api/stats
```
- **μƒνƒ**: β… 200 OK
- **μ‘λ‹µ**: ν†µκ³„ λ°μ΄ν„° λ°ν™
- **λΉ„κ³ **: ν†µκ³„ μ§‘κ³„ μ‹μ¤ν… μ •μƒ

---

### 5. κΈ°νƒ€ API (2/2)

#### 5-1. μ›μΉλ¦¬μ¤νΈ μ΅°ν
```bash
GET https://invest-web-service.vercel.app/api/watchlist?portfolioId=main
```
- **μƒνƒ**: β… 200 OK
- **μ‘λ‹µ**: `{ "success": true, "data": [] }`
- **λΉ„κ³ **: μ›μΉλ¦¬μ¤νΈ μ‹μ¤ν… μ •μƒ (λ°μ΄ν„° μ—†μ)

#### 5-2. μ£Όκ°„ λ¦¬ν¬νΈ μ΅°ν
```bash
GET https://invest-web-service.vercel.app/api/weekly-reports?portfolioId=main
```
- **μƒνƒ**: β… 200 OK
- **μ‘λ‹µ**: `{ "success": true, "data": [] }`
- **λΉ„κ³ **: μ£Όκ°„ λ¦¬ν¬νΈ μ‹μ¤ν… μ •μƒ (λ°μ΄ν„° μ—†μ)

---

## β μ‹¤ν¨ν• API μ—”λ“ν¬μΈνΈ

### 1. κ°μΈν™” λ‰΄μ¤ API

```bash
GET https://invest-web-service.vercel.app/api/news/personalized?portfolioId=main
```

- **μƒνƒ**: β 400 Bad Request
- **μ—λ¬**: `{ "error": "userIdκ°€ ν•„μ”ν•©λ‹λ‹¤." }`
- **μ›μΈ**: APIκ°€ `userId` νλΌλ―Έν„°λ¥Ό ν•„μλ΅ μ”κµ¬
- **ν•΄κ²° λ°©λ²•**:
  1. **μµμ… A**: API μ½”λ“ μμ •ν•μ—¬ `userId`λ¥Ό μ„ νƒ νλΌλ―Έν„°λ΅ λ³€κ²½
  2. **μµμ… B**: μΈμ¦ ν† ν°μ—μ„ `userId` μλ™ μ¶”μ¶
  3. **μµμ… C**: ν…μ¤νΈ μ‹ `userId` νλΌλ―Έν„° μ¶”κ°€

**μμ • μ μ•**:
```typescript
// mgk-dashboard/app/api/news/personalized/route.ts
const userId = searchParams.get('userId') || 'default_user'; // κΈ°λ³Έκ°’ μ¶”κ°€
```

---

### 2. μ΄κΈ° ν…μ¤νΈ μ‹ νλΌλ―Έν„° μ¤λ¥ (ν•΄κ²°λ¨)

λ‹¤μ APIλ“¤μ€ μ΄κΈ°μ— μ‹¤ν¨ν–μΌλ‚, μ¬λ°”λ¥Έ νλΌλ―Έν„° μ‚¬μ© ν›„ μ„±κ³µ:

#### 2-1. μ£Όμ‹ κ²€μƒ‰ API
- β **μλ»λ μ”μ²­**: `?query=AAPL` β†’ 400 Error
- β… **μ¬λ°”λ¥Έ μ”μ²­**: `?q=AAPL` β†’ 200 OK
- **κµν›**: API λ¬Έμ„ν™” ν•„μ” (νλΌλ―Έν„° μ΄λ¦„ λ…ν™•ν)

#### 2-2. ν¬μ§€μ…/κ±°λ/μ”κ³  API
- β **μλ»λ μ”μ²­**: νλΌλ―Έν„° μ—†μ β†’ 400 Error
- β… **μ¬λ°”λ¥Έ μ”μ²­**: `?portfolioId=main` β†’ 200 OK
- **κµν›**: ν•„μ νλΌλ―Έν„° λ…ν™•ν λ¬Έμ„ν™”

---

## π” μƒμ„Έ λ¶„μ„

### 1. API μ‘λ‹µ μ‹κ°„

| API μΉ΄ν…κ³ λ¦¬ | ν‰κ·  μ‘λ‹µ μ‹κ°„ | λΉ„κ³  |
|-------------|--------------|------|
| κΈ°λ³Έ νμ΄μ§€ | ~200ms | μ •μƒ |
| μ£Όμ‹ κ²€μƒ‰ | ~800ms | Alpha Vantage API νΈμ¶ ν¬ν•¨ |
| Firestore μ΅°ν | ~300ms | μ •μƒ |
| λ¶„μ„ API | ~500ms | κ³„μ‚° λ΅μ§ ν¬ν•¨ |

### 2. Firebase μ—°λ™ μƒνƒ

β… **μ •μƒ μ‘λ™ ν™•μΈ**:
- Firestore λ°μ΄ν„° μ½κΈ° μ„±κ³µ
- κΈ°μ΅΄ ν¬μ§€μ… λ°μ΄ν„° μ΅°ν μ„±κ³µ
- νƒ€μ„μ¤νƒ¬ν”„ μ§λ ¬ν™” μ •μƒ μ‘λ™

### 3. μ™Έλ¶€ API μ—°λ™ μƒνƒ

β… **Alpha Vantage API**:
- μ£Όμ‹ κ²€μƒ‰ μ •μƒ μ‘λ™
- API ν‚¤ μ •μƒ μΈμ¦
- Rate limit λ¬Έμ  μ—†μ

β… **ν™μ¨ API**:
- μ‹¤μ‹κ°„ ν™μ¨ μ΅°ν μ •μƒ
- USD/KRW λ³€ν™ μ •μƒ

### 4. μΈμ¦ μ‹μ¤ν…

β οΈ **ν„μ¬ μƒνƒ**:
- λ€λ¶€λ¶„μ APIκ°€ `default_user` ν•λ“μ½”λ”© μ‚¬μ©
- μ‹¤μ  μΈμ¦ ν† ν° κ²€μ¦ λ―Έκµ¬ν„
- κ°μΈν™” λ‰΄μ¤ APIλ§ `userId` ν•„μ μ²΄ν¬

**κ°μ„  ν•„μ”**:
- Firebase Auth ν† ν° κ²€μ¦ λ―Έλ“¤μ›¨μ–΄ μ¶”κ°€
- λ¨λ“  APIμ— μΌκ΄€λ μΈμ¦ λ΅μ§ μ μ©

---

## π“ ν…μ¤νΈ λ°μ΄ν„° λ¶„μ„

### λ°κ²¬λ κΈ°μ΅΄ λ°μ΄ν„°

#### ν¬μ§€μ… λ°μ΄ν„°
```json
{
  "id": "main_MGK",
  "symbol": "MGK",
  "purchaseMethod": "auto",
  "autoInvestConfig": {
    "isActive": true,
    "frequency": "daily",
    "startDate": "2025-09-10",
    "amount": 5
  },
  "shares": 0,
  "averagePrice": 0,
  "totalValue": 0
}
```

**λ¶„μ„**:
- MGK ETF μλ™ ν¬μ μ„¤μ • μ΅΄μ¬
- ν•μ§€λ§ `shares: 0`, `totalValue: 0` β†’ κ±°λ λ‚΄μ—­ λ―Έμƒμ„±
- **λ¬Έμ **: μλ™ ν¬μ κ±°λ μƒμ„± λ΅μ§μ΄ μ‹¤ν–‰λμ§€ μ•μ
- **μ›μΈ**: 2025-09-10λ¶€ν„° λ§¤μΌ $5 ν¬μ μ„¤μ •μ΄μ§€λ§, μ‹¤μ  κ±°λ λ‚΄μ—­ μ—†μ

**ν•΄κ²° ν•„μ”**:
1. μλ™ ν¬μ κ±°λ μƒμ„± ν•¨μ μ‹¤ν–‰
2. λλ” κΈ°μ΅΄ ν¬μ§€μ… λ°μ΄ν„° μ •λ¦¬

---

## π› λ°κ²¬λ μ΄μ

### μ΄μ #1: κ°μΈν™” λ‰΄μ¤ API userId ν•„μ μ²΄ν¬
- **μ‹¬κ°λ„**: π΅ μ¤‘κ°„
- **μν–¥**: λ‰΄μ¤ κΈ°λ¥ μ‚¬μ© λ¶κ°€
- **ν•΄κ²° μ°μ„ μμ„**: λ†’μ

### μ΄μ #2: API νλΌλ―Έν„° λ¶μΌμΉ
- **μ‹¬κ°λ„**: π΅ μ¤‘κ°„
- **μν–¥**: μ‚¬μ©μ νΌλ€ κ°€λ¥
- **ν•΄κ²° λ°©λ²•**: API λ¬Έμ„ μ‘μ„± λλ” νλΌλ―Έν„° μ΄λ¦„ ν†µμΌ

### μ΄μ #3: μλ™ ν¬μ κ±°λ λ―Έμƒμ„±
- **μ‹¬κ°λ„**: π΅ μ¤‘κ°„
- **μν–¥**: ν¬νΈν΄λ¦¬μ¤ λ°μ΄ν„° λ¶μΌμΉ
- **ν•΄κ²° λ°©λ²•**: κΈ°μ΅΄ ν¬μ§€μ… μ¬μ²λ¦¬ λλ” μ‚­μ 

### μ΄μ #4: μΈμ¦ μ‹μ¤ν… λ―Έμ™„μ„±
- **μ‹¬κ°λ„**: π”΄ λ†’μ
- **μν–¥**: λ³΄μ• μ·¨μ•½μ 
- **ν•΄κ²° λ°©λ²•**: Firebase Auth λ―Έλ“¤μ›¨μ–΄ μ¶”κ°€

---

## β… κ²€μ¦λ κΈ°λ¥

### 1. ν•µμ‹¬ κΈ°λ¥
- β… μ£Όμ‹ κ²€μƒ‰ (US μ‹μ¥)
- β… ν¬μ§€μ… κ΄€λ¦¬ (μ΅°ν)
- β… κ±°λ λ‚΄μ—­ κ΄€λ¦¬
- β… μ”κ³  κ΄€λ¦¬
- β… ν¬νΈν΄λ¦¬μ¤ λ¶„μ„
- β… ν™μ¨ μ΅°ν
- β… ν†µκ³„ μ§‘κ³„

### 2. λ°μ΄ν„° μ‹μ¤ν…
- β… Firestore μ—°λ™
- β… νƒ€μ„μ¤νƒ¬ν”„ μ§λ ¬ν™”
- β… λ‹¤μ¤‘ ν¬νΈν΄λ¦¬μ¤ μ§€μ›
- β… μλ™ ν¬μ μ„¤μ • μ €μ¥

### 3. μ™Έλ¶€ API μ—°λ™
- β… Alpha Vantage (μ£Όμ‹ κ²€μƒ‰)
- β… ν™μ¨ API
- β οΈ Yahoo Finance (ν•κµ­ μ£Όμ‹) - λ―Έν…μ¤νΈ

---

## π― κ¶μ¥ μ‚¬ν•­

### μ¦‰μ‹ μ΅°μΉ ν•„μ”
1. β… **κ°μΈν™” λ‰΄μ¤ API μμ •**
   - `userId`λ¥Ό μ„ νƒ νλΌλ―Έν„°λ΅ λ³€κ²½
   - λλ” μΈμ¦ ν† ν°μ—μ„ μλ™ μ¶”μ¶

2. β… **API λ¬Έμ„ μ‘μ„±**
   - λ¨λ“  μ—”λ“ν¬μΈνΈ νλΌλ―Έν„° λ…μ‹
   - μμ  μ”μ²­/μ‘λ‹µ μ¶”κ°€
   - Postman μ»¬λ ‰μ… μƒμ„±

3. β… **κΈ°μ΅΄ ν¬μ§€μ… λ°μ΄ν„° μ •λ¦¬**
   - MGK ν¬μ§€μ… μ¬μ²λ¦¬ λλ” μ‚­μ 
   - μλ™ ν¬μ κ±°λ μƒμ„± μ‹¤ν–‰

### λ‹¨κΈ° κ°μ„  (1-2μ£Ό)
1. **μΈμ¦ λ―Έλ“¤μ›¨μ–΄ μ¶”κ°€**
   - Firebase Auth ν† ν° κ²€μ¦
   - λ¨λ“  APIμ— μΌκ΄€λ μΈμ¦ μ μ©

2. **μ—λ¬ ν•Έλ“¤λ§ κ°μ„ **
   - μΌκ΄€λ μ—λ¬ μ‘λ‹µ ν•μ‹
   - μƒμ„Έν• μ—λ¬ λ©”μ‹μ§€

3. **API ν…μ¤νΈ μλ™ν™”**
   - CI/CD νμ΄ν”„λΌμΈμ— API ν…μ¤νΈ μ¶”κ°€
   - λ°°ν¬ μ „ μλ™ κ²€μ¦

### μ¤‘κΈ° κ°μ„  (1κ°μ›”)
1. **API μ„±λ¥ μµμ ν™”**
   - μΊμ‹± μ „λµ κ°μ„ 
   - λ¶ν•„μ”ν• Firestore μ½κΈ° μµμ†ν™”

2. **λ¨λ‹ν„°λ§ μ‹μ¤ν…**
   - API μ‘λ‹µ μ‹κ°„ μ¶”μ 
   - μ—λ¬μ¨ λ¨λ‹ν„°λ§
   - μ‚¬μ©λ‰ λ¶„μ„

3. **ν•κµ­ μ£Όμ‹ κ²€μƒ‰ ν…μ¤νΈ**
   - Yahoo Finance API κ²€μ¦
   - ν•κµ­ μ£Όμ‹ λ°μ΄ν„° ν’μ§ ν™•μΈ

---

## π“ ν…μ¤νΈ μ¤ν¬λ¦½νΈ

### μƒμ„±λ νμΌ
1. **`test-vercel-api.js`** - Node.js μƒμ„Έ ν…μ¤νΈ
2. **`test-api-simple.sh`** - Bash κ°„λ‹¨ ν…μ¤νΈ
3. **`API_TEST_GUIDE.md`** - μ™„μ „ν• ν…μ¤νΈ κ°€μ΄λ“

### μ‚¬μ© λ°©λ²•
```bash
# κ°„λ‹¨ ν…μ¤νΈ
./test-api-simple.sh https://invest-web-service.vercel.app

# μƒμ„Έ ν…μ¤νΈ
node test-vercel-api.js
```

---

## π‰ κ²°λ΅ 

### μ „μ²΄ ν‰κ°€: β­β­β­β­β† (4/5)

**μ¥μ **:
- β… ν•µμ‹¬ κΈ°λ¥ λ€λ¶€λ¶„ μ •μƒ μ‘λ™
- β… Firebase μ—°λ™ μ•μ •μ 
- β… μ™Έλ¶€ API μ—°λ™ μ„±κ³µ
- β… λ°°ν¬ ν”„λ΅μ„Έμ¤ μ›ν™

**κ°μ„  ν•„μ”**:
- β οΈ μΈμ¦ μ‹μ¤ν… κ°•ν™”
- β οΈ API λ¬Έμ„ν™”
- β οΈ μΌλ¶€ API νλΌλ―Έν„° κ²€μ¦ κ°μ„ 

**μΆ…ν•© μκ²¬**:
Vercel λ°°ν¬κ°€ μ„±κ³µμ μΌλ΅ μ™„λ£λμ—μΌλ©°, μ£Όμ” APIλ“¤μ΄ μ •μƒμ μΌλ΅ μ‘λ™ν•κ³  μμµλ‹λ‹¤. 
μΌλ¶€ κ°μ„ μ΄ ν•„μ”ν• λ¶€λ¶„μ΄ μμ§€λ§, μ „λ°μ μΌλ΅ ν”„λ΅λ•μ… ν™κ²½μ—μ„ μ‚¬μ© κ°€λ¥ν• μμ¤€μ…λ‹λ‹¤.

---

## π“ λ‹¤μ λ‹¨κ³„

1. β… **κ°μΈν™” λ‰΄μ¤ API μμ •** (μ°μ„ μμ„: λ†’μ)
2. β… **API λ¬Έμ„ μ‘μ„±** (μ°μ„ μμ„: λ†’μ)
3. β³ **μΈμ¦ λ―Έλ“¤μ›¨μ–΄ μ¶”κ°€** (μ°μ„ μμ„: μ¤‘κ°„)
4. β³ **ν”„λ΅ νΈμ—”λ“ ν†µν•© ν…μ¤νΈ** (μ°μ„ μμ„: μ¤‘κ°„)
5. β³ **μ„±λ¥ μµμ ν™”** (μ°μ„ μμ„: λ‚®μ)

---

**μ‘μ„±μ**: AI Assistant  
**ν…μ¤νΈ μΌμ‹**: 2025-10-31 13:30 (KST)  
**λ°°ν¬ URL**: https://invest-web-service.vercel.app  
**μƒνƒ**: β… λ°°ν¬ μ„±κ³µ, API λ€λ¶€λ¶„ μ •μƒ μ‘λ™

